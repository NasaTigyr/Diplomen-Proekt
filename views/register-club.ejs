<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register Your Club - Martial Arts Competitions</title>
    <link rel="stylesheet" href="/styleIndex.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <!-- Include the navigation header -->
    <%- include('header', {currentPage: 'register-club', user: user}); %>
    
    <div class="container my-5">
        <h1 class="text-center mb-4">Register Your Martial Arts Club</h1>
        
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="alert alert-info mb-4">
                    <h5>Benefits of registering your club:</h5>
                    <ul>
                        <li>Create and manage martial arts competitions</li>
                        <li>Add and manage your club's competitors</li>
                        <li>Track your athletes' performances</li>
                    </ul>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h4 class="mb-0">Club Registration Form</h4>
                    </div>
                    <div class="card-body">
                        <div id="alert-container" class="alert d-none mb-4" role="alert"></div>
                        
                        <form id="club-registration-form">
                            <div class="mb-3">
                                <label for="club_name" class="form-label">Club Name *</label>
                                <input type="text" class="form-control" id="club_name" name="club_name" required>
                            </div>
                            
                            <div class="mb-3">
                                <label for="registration_code" class="form-label">Official Registration Code *</label>
                                <input type="text" class="form-control" id="registration_code" name="registration_code" required>
                                <div class="form-text">Enter the registration code issued by your national sports federation or local municipality.</div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="address" class="form-label">Club Address *</label>
                                <input type="text" class="form-control" id="address" name="address" required>
                            </div>
                            
                            <div class="mb-3">
                                <label for="phone" class="form-label">Contact Phone *</label>
                                <input type="tel" class="form-control" id="phone" name="phone" required>
                            </div>
                            
                            <div class="mb-3">
                                <label for="description" class="form-label">Club Description</label>
                                <textarea class="form-control" id="description" name="description" rows="3"></textarea>
                                <div class="form-text">Describe your club, including martial arts styles, history, and achievements.</div>
                            </div>
                            
                            <div class="mb-3 form-check">
                                <input type="checkbox" class="form-check-input" id="terms" name="terms" required>
                                <label class="form-check-label" for="terms">I confirm that I am authorized to register this club and that all information provided is accurate.</label>
                            </div>
                            
                            <div class="d-grid">
                                <button type="submit" class="btn btn-primary">Register Club</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer -->
    <footer class="bg-light text-center py-3 mt-5">
        <p>&copy; 2025 Martial Arts Competitions. All Rights Reserved.</p>
    </footer>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('club-registration-form');
            form.addEventListener('submit', registerClub);
        });
        
        function registerClub(e) {
            e.preventDefault();
            
            const data = {
                club_name: document.getElementById('club_name').value,
                registration_code: document.getElementById('registration_code').value,
                address: document.getElementById('address').value,
                phone: document.getElementById('phone').value,
                description: document.getElementById('description').value
            };
            
            fetch('/api/register-club', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            })
            .then(response => {
                if (!response.ok) {
                    return response.json().then(data => {
                        throw new Error(data.message || 'Failed to register club');
                    });
                }
                return response.json();
            })
            .then(data => {
                showAlert('Club registration successful! You can now create events and manage your athletes.', 'success');
                
                // Redirect to profile page after a delay
                setTimeout(() => {
                    window.location.href = '/profile';
                }, 3000);
            })
            .catch(error => {
                showAlert(error.message, 'danger');
            });
        }
        
        function showAlert(message, type) {
            const alertContainer = document.getElementById('alert-container');
            alertContainer.textContent = message;
            alertContainer.className = `alert alert-${type}`;
        }
    </script>
</body>
</html>
